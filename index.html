<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="board">
      <table>
        <tr class="upper">
          <td class="endcap" rowspan="2">A</td>
          <td id="0"></td>
          <td id="1"></td>
          <td id="2"></td>
          <td id="3"></td>
          <td id="4"></td>
          <td id="5"></td>
          <td class="endcap" rowspan="2">B</td>
        </tr>
        <tr class="lower">
          <td id="11"></td>
          <td id="10"></td>
          <td id="9"></td>
          <td id="8"></td>
          <td id="7"></td>
          <td id="6"></td>
        </tr>
      </table>
    </div>
    <script>
      //INITIALIZE

      //grabbing all cells
      const pitsA = document.querySelectorAll(".upper td:not(.endcap)"); //everything on the top and the two end zones.
      const pitsB = document.querySelectorAll(".lower td"); //everything on the bottom and no end zones.

      //seperating goal A and goal B into seperate elements for ease of use
      const goals = document.querySelectorAll("td.endcap");
      goals.forEach((x) => x.setAttribute("value", "0"));

      // Player A moves will use the first, while when player B moves it uses the second.
      // This is to avoid needing to do extra logic when moving around the board and allows for more code reuse.
      var myPitsA = [];
      var myPitsB = [];

      for (let pit of pitsA) {
        myPitsA.push(pit);
        myPitsB.push(pit);
      }

      // Add B goal to middle of B list.
      myPitsB.push(goals[1]);

      for (let i = pitsB.length - 1; i >= 0; i--) {
        myPitsA.push(pitsB[i]);
        myPitsB.push(pitsB[i]);
      }

      //add A goal to end of A list.
      myPitsA.push(goals[0]);
      console.log(myPitsA);

      pitsA.forEach((x) => {
        x.setAttribute("value", "4");
        x.addEventListener("click", () => {
          move_next(event, myPitsA);
        });
      });
      pitsB.forEach((x) => {
        x.setAttribute("value", "4");
        x.addEventListener("click", () => move_next(event, myPitsA));
      });

      //END INITIALIZE

      function move_next(event, playerPits) {
        let stones = Number(event.target.getAttribute("value"));
        event.target.setAttribute("value", 0);
        console.log(stones);
        let numPOS = num_check(playerPits.indexOf(event.target) + 1);

        while (stones > 0) {
          var newStones = Number(playerPits[numPOS].getAttribute("value")) + 1;
          playerPits[numPOS].setAttribute("value", newStones);
          stones = stones - 1;
          numPOS = num_check(numPOS + 1);
        }
      }

      function num_check(num) {
        if (num > 12) {
          return (num % 12) - 1;
        }
        return num;
      }
    </script>
  </body>
</html>
